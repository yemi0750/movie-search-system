<!--
Author: W3layouts
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<meta charset="UTF-8">
<!DOCTYPE HTML>
<html>
	<head>
		<title>Movie Searching System</title>
		<link href="css/style.css" rel='stylesheet' type='text/css' />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
		</script>
		<!----webfonts---->
		<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
		<!----//webfonts---->
		<!-- Global CSS for the page and tiles -->
  		<link rel="stylesheet" href="css/main.css">
  		<!-- //Global CSS for the page and tiles -->
		<!---start-click-drop-down-menu----->
		<script src="js/jquery.min.js"></script>
        <!----start-dropdown--->
         <script type="text/javascript">
			var $ = jQuery.noConflict();
				$(function() {
					$('#activator').click(function(){
						$('#box').animate({'top':'0px'},500);
					});
					$('#boxclose').click(function(){
					$('#box').animate({'top':'-700px'},500);
					});
				});
				$(document).ready(function(){
				//Hide (Collapse) the toggle containers on load
				$(".toggle_container").hide(); 
				//Switch the "Open" and "Close" state per click then slide up/down (depending on open/close state)
				$(".trigger").click(function(){
					$(this).toggleClass("active").next().slideToggle("slow");
						return false; //Prevent the browser jump to the link anchor
				});
									
			});
		</script>
        <!----//End-dropdown--->
	</head>
	<body>
		<!---start-wrap---->
			<!---start-header---->
			<div class="header">
				<div class="wrap">
				<div class="logo">
					<a href="index.html"><img src="logo.jpg" width="70dp" title="logo" /></a>
				</div>
				<div class="top-searchbar">
					<form method="post" action="search.html">
						<div class="icon"><span class="searchbar_icon"></span></div>
                		<select name="searchbar_choose" id="" class="searchbar_choose">
                  			<option value="total">통합검색</option>
                    		<option value="movie">영화검색</option>
                    		<option value="actor">배우검색</option>
                    		<option value="director">감독검색</option>
                  		</select>
                		<input name="searchbar_text" type="text" class="searchbar_text" placeholder="검색어를 입력하세요">
                		<input type="submit" value="">
            		</form>
				</div>
				<div class="menu">
					<div class="mmenu">
						<ul>
							<li><a href="mypage.html"><span>마이페이지</span></a></li>
							<li><a href="mylist.html"><span>관심목록</span></a></li>
							<li><a href="login.html"><span>로그아웃</span></a></li>
						</ul>
					</div>
				</div>
				<div class="clear"> </div>
			</div>
		</div>
		<!---//End-header---->
		<!---start-content---->
		<div class="content">
			<div class="wrap">
			<div class="single-page">
							<div class="single-page-artical">
								<div class="artical-content">
									<?php
	$dbname="movie_is_jojo";
	$conn=mysqli_connect("localhost:3306","root","5212245",$dbname) or die("mysql 접속 실패");
	mysqli_set_charset($conn, 'utf8');
	mysqli_select_db($conn,$dbname);
	$id=$_GET['id'];
	$title=$_GET['title'];
	$count=0;
	if($id=="movie"){
		$sql="SELECT m.image, m.movie_name, m.release_date, m.nation, m.running_time, m.age, m.rate, m.story, d.director_name FROM (movies AS m JOIN (make JOIN directors AS d ON make.director_id=d.director_id) ON make.movie_id=m.movie_id) WHERE m.movie_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			if($count==0){
				echo '<div class="single_poster"><img src="'.$result['image'].'" title="banner1"></div><div  class="single_content">
									<h2 class="sp_title">'.$result['movie_name'].'</h2>
									<p class="sp_detail">'.$result['release_date'].' 개봉 | '.$result['nation'].'<br>'.$result['running_time'].'분 | '.$result['age'].'<br>평점 '.$result['rate'].'/10<br>감독 <a href=\'single-page.html?id=director&title='.$result['director_name'].'\'>'.$result['director_name'].'</a>';
			}
			if($count>0 && $count<($result_set->num_rows)){
			echo ', <a href=\'single-page.html?id=director&title='.$result['director_name'].'\'>'.$result['director_name'].'</a>';
			}
			if($count==($result_set->num_rows)-1){
				echo '</p> </div>
								    </div><div class="clear"> </div></div>
								    <div class="story-section">
								    <h2>줄거리</h2>
									<div class="content">'.$result['story'].'</div></div>';
			}
			$count=$count+1;
		}
	}else if($id=="actor"){
		$sql="SELECT a.image_link, a.actor_name, a.agency, a.debut, a.date_of_birth, a.height, a.gender, aa.awards_a, aa.awards_b FROM (actors AS a JOIN awards_actor AS aa ON a.actor_id=aa.actor_id) WHERE actor_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			echo '<div class="single_poster"><img src="'.$result['image_link'].'" title="banner1"></div><div  class="single_content">
									<h2 class="sp_title">'.$result['actor_name'].'</h2>
									<p class="sp_detail">';
			if($result['gender']){
				echo $result['gender'].'<br>';
			}
			if($result['agency']){
				echo $result['agency'].' 소속<br>';
			}
			if($result['debut']){
				echo '데뷔 '.$result['debut'].'<br>';
			}
			if($result['date_of_birth']){
				echo '출생 '.$result['date_of_birth'].'<br>';
			}
			if($result['height']){
				echo '신체 '.$result['height'].'<br>';
			}
			if($result['awards_a']){
				echo '수상<br>'.$result['awards_a'].'<br>'.$result['awards_b'];
			}
			echo '</p> </div></div><div class="clear"> </div></div>';
		}
	}else if($id=="director"){
		$sql="SELECT d.image, d.director_name, d.gender, d.date_of_birth_director, d.debut, ad.awards_a, ad.awards_b FROM (directors AS d JOIN awards_director AS ad ON d.director_id=ad.director_id) WHERE director_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			echo '<div class="single_poster"><img src="'.$result['image'].'" title="banner1"></div><div  class="single_content">
									<h2 class="sp_title">'.$result['director_name'].'</h2>
									<p class="sp_detail">';
			if($result['gender']){
				echo $result['gender'].'<br>';
			}
			if($result['date_of_birth_director']){
				echo '출생 '.$result['date_of_birth_director'].'<br>';
			}
			if($result['debut']){
				echo '데뷔 '.$result['debut'].'<br>';
			}
			if($result['awards_a']){
				echo '수상<br>'.$result['awards_a'].'<br>'.$result['awards_b'];
			}
			echo '</p> </div></div><div class="clear"> </div></div>';
		}
	}else if($id=="user"){
	
	}
	mysqli_close($conn);
?>
		  						 
							<!---start-comments-section--->
							<div class="comment-section">
				<div class="grids_of_2">
						<?php
	$dbname="movie_is_jojo";
	$conn=mysqli_connect("localhost:3306","root","5212245",$dbname) or die("mysql 접속 실패");
	mysqli_set_charset($conn, 'utf8');
	mysqli_select_db($conn,$dbname);
	$id=$_GET['id'];
	$title=$_GET['title'];
	if($id=="movie"){
		echo '<h2>출연정보</h2>';
		$sql="SELECT a.actor_name, a.image_link FROM (movies AS m JOIN (appear JOIN actors AS a ON appear.actor_code=a.actor_id) ON appear.movie_code=m.movie_id) WHERE m.movie_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			echo '<div class="grids_of_1"><div class="grid_img"><a href=\'single-page.html?id=actor&title='.$result['actor_name'].'\'><img src="'.$result['image_link'].'" title="actor"></div><div  class="grid_text">
									<h4 class="style1 list">'.$result['actor_name'].'</h4>
									<p class="para top"></p></div><div class="clear"></div></div>';
		}
	}else if($id=="actor"){
		echo '<h2>출연작품</h2>';
		$sql="SELECT m.movie_name, m.image,m.release_date FROM (movies AS m JOIN (appear JOIN actors AS a ON appear.actor_code=a.actor_id) ON appear.movie_code=m.movie_id) WHERE a.actor_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			echo '<div class="grids_of_1"><div class="grid_img"><a href=\'single-page.html?id=movie&title='.$result['movie_name'].'\'><img src="'.$result['image'].'" title="movie"></div><div  class="grid_text">
									<h4 class="style1 list">'.$result['movie_name'].'</h4>
									<p class="para top">'.$result['release_date'].'</p></div><div class="clear"></div></div>';
		}
	}else if($id=="director"){
		echo '<h2>연출작품</h2>';
		$sql="SELECT m.movie_name, m.image,m.release_date FROM (movies AS m JOIN (make JOIN directors AS d ON make.director_id=d.director_id) ON make.movie_id=m.movie_id) WHERE d.director_name='$title'";
		$result_set=mysqli_query($conn,$sql);
		while($result=mysqli_fetch_array($result_set)){
			echo '<div class="grids_of_1"><div class="grid_img"><a href=\'single-page.html?id=movie&title='.$result['movie_name'].'\'><img src="'.$result['image'].'" title="movie"></div><div  class="grid_text">
									<h4 class="style1 list">'.$result['movie_name'].'</h4>
									<p class="para top">'.$result['release_date'].'</p></div><div class="clear"></div></div>';
		}
	}else if($id=="user"){

	}
	mysqli_close($conn);
?>
				</div>
					</div>
		<!---//End-comments-section--->
		<!----start-footer--->
		<div class="footer">
			<p>DB Project : 영화는 조조</p>
		</div>
		<!----//End-footer--->
		<!---//End-wrap---->
	</body>
</html>

